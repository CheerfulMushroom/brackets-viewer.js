!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRanking=t.rankingHeader=t.isMajorRound=t.getOriginAbbreviation=t.splitBy=void 0;const r=n(1);function i(e,t,n,r){if(!n||null===n.id)return;const i=e[n.id]||{rank:0,id:0,played:0,wins:0,draws:0,losses:0,forfeits:0,scoreFor:0,scoreAgainst:0,scoreDifference:0,points:0};i.id=n.id,i.played++,"win"===n.result&&i.wins++,"draw"===n.result&&i.draws++,"loss"===n.result&&i.losses++,n.forfeit&&i.forfeits++,i.scoreFor+=n.score||0,i.scoreAgainst+=r&&r.score||0,i.scoreDifference=i.scoreFor-i.scoreAgainst,i.points=t(i),e[n.id]=i}t.splitBy=function(e,t){const n=Object();for(const r of e)n[r[t]]||(n[r[t]]=[]),n[r[t]].push(r);return Object.values(n)},t.getOriginAbbreviation=function(e,t,n){return t&&"lower-bracket"===e&&1===n?r.abbreviations.seed:"lower-bracket"===e||"final-group"===e?r.abbreviations.position:r.abbreviations.seed},t.isMajorRound=function(e){return 1===e||e%2==0},t.rankingHeader=function(e){return r.headers[e]},t.getRanking=function(e,t){t=t||(e=>3*e.wins+1*e.draws+0*e.losses);const n={};for(const r of e)i(n,t,r.opponent1,r.opponent2),i(n,t,r.opponent2,r.opponent1);return function(e){const t=Object.values(e).sort((e,t)=>t.points-e.points),n={value:0,lastPoints:-1};for(const e of t)e.rank=n.lastPoints!==e.points?++n.value:n.value,n.lastPoints=e.points;return t}(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headers=t.abbreviations=t.getLoserBracketRoundName=t.getWinnerBracketRoundName=t.getRoundName=t.getGroupName=t.getGrandFinalName=t.getMatchStatus=t.getFinalOriginHint=t.getFinalMatchLabel=t.getMatchLabel=t.getOriginHint=void 0;const r=n(4),i=n(0);function o(e,t){return 1===t?"Grand Final":"GF Round "+e}t.getOriginHint=function(e,t,n,r){if(1===e&&("upper-bracket"===r||"lower-bracket"===r&&n))return e=>"Seed "+e;if("lower-bracket"===r&&i.isMajorRound(e)){if(e===t-2)return e=>"Loser of WB Semi "+e;if(e===t)return()=>"Loser of WB Final";const r=Math.ceil((e+1)/2);return n?e=>`Loser of WB ${r-1}.${e}`:e=>`Loser of WB ${r}.${e}`}},t.getMatchLabel=function(e,t,n,r){const i="upper-bracket"===r?"WB":"lower-bracket"===r?"LB":"M";return"upper-bracket"===r&&t===n-1?`${i} Semi ${e}`:t===n?i+" Final":`${i} ${t}.${e}`},t.getFinalMatchLabel=function(e,t,n){return"consolation_final"===e?"Consolation Final":o(t,n)},t.getFinalOriginHint=function(e,t){return"consolation_final"===e?e=>"Loser of Semi "+e:1===t?()=>"Winner of LB Final":void 0},t.getMatchStatus=function(e){switch(e){case r.Status.Locked:return"Locked";case r.Status.Waiting:return"Waiting";case r.Status.Ready:return"Ready";case r.Status.Running:return"Running";case r.Status.Completed:return"Completed";case r.Status.Archived:return"Archived"}},t.getGrandFinalName=o,t.getGroupName=function(e){return"Group "+e},t.getRoundName=function(e,t){return e===t?"Final Round":"Round "+e},t.getWinnerBracketRoundName=function(e,t){return e===t?"WB Final Round":"WB Round "+e},t.getLoserBracketRoundName=function(e,t){return e===t?"LB Final Round":"LB Round "+e},t.abbreviations={win:"W",loss:"L",forfeit:"F",position:"P",seed:"#"},t.headers={rank:{text:"#",tooltip:"Rank"},id:{text:"Name",tooltip:"Name"},played:{text:"P",tooltip:"Played"},wins:{text:t.abbreviations.win,tooltip:"Wins"},draws:{text:"D",tooltip:"Draws"},losses:{text:t.abbreviations.loss,tooltip:"Losses"},forfeits:{text:t.abbreviations.forfeit,tooltip:"Forfeits"},scoreFor:{text:"SF",tooltip:"Score For"},scoreAgainst:{text:"SA",tooltip:"Score Against"},scoreDifference:{text:"+/-",tooltip:"Score Difference"},points:{text:"Pts",tooltip:"Points"}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BracketsViewer=void 0,n(3);const a=n(0),c=o(n(5)),s=o(n(1));class u{constructor(){this.teamRefsDOM={}}render(e,t,n){const r=document.querySelector(e);if(!r)throw Error('Root not found. You must have a root element with id "root"');this.config={participantOriginPlacement:n&&n.participantOriginPlacement||"before",showSlotsOrigin:!n||void 0===n.showSlotsOrigin||n.showSlotsOrigin,showLowerBracketSlotsOrigin:!n||void 0===n.showLowerBracketSlotsOrigin||n.showLowerBracketSlotsOrigin,highlightParticipantOnHover:!n||void 0===n.highlightParticipantOnHover||n.highlightParticipantOnHover},this.skipFirstRound=t.stage.settings.skipFirstRound||!1,this.participants=t.participants,t.participants.forEach(e=>this.teamRefsDOM[e.id]=[]);const i=a.splitBy(t.matches,"group_id");switch(t.stage.type){case"round_robin":this.renderRoundRobin(r,t.stage.name,i);break;case"single_elimination":case"double_elimination":this.renderElimination(r,t.stage.name,t.stage.type,i);break;default:throw Error("Unknown bracket type: "+t.stage.type)}}renderRoundRobin(e,t,n){const r=c.createRoundRobinContainer();let i=1;for(const e of n){const t=c.createGroupContainer(s.getGroupName(i++)),n=a.splitBy(e,"round_id");let o=1;for(const e of n){const n=c.createRoundContainer(s.getRoundName(o++,0));for(const t of e)n.append(this.createMatch(t));t.append(n)}t.append(this.createRanking(e)),r.append(t)}e.append(c.createTitle(t),r)}renderElimination(e,t,n,r){e.append(c.createTitle(t)),"single_elimination"===n?this.renderSingleElimination(e,r):this.renderDoubleElimination(e,r)}renderSingleElimination(e,t){const n=void 0!==t[1];this.renderBracket(e,a.splitBy(t[0],"round_id"),s.getRoundName),n&&this.renderFinal("consolation_final",t[1])}renderDoubleElimination(e,t){const n=void 0!==t[1],r=void 0!==t[2];this.renderBracket(e,a.splitBy(t[0],"round_id"),s.getWinnerBracketRoundName,!1,r),n&&this.renderBracket(e,a.splitBy(t[1],"round_id"),s.getLoserBracketRoundName,!0),r&&this.renderFinal("grand_final",t[2])}renderBracket(e,t,n,r,i){const o=r?"lower-bracket":"upper-bracket",a=c.createBracketContainer(),s=t.length;let u=1;for(const e of t){const t=c.createRoundContainer(n(u,s));for(const n of e)t.append(this.createBracketMatch(u,s,n,o,i));a.append(t),u++}e.append(a)}renderFinal(e,t){const n=document.querySelector(".bracket");if(!n)throw Error("Upper bracket not found.");const r=t[0].opponent1,i=r&&null!=r.id&&"win"!=r.result?2:1,o=t.slice(0,i),a=t.length;for(let t=1;t<=o.length;t++){const r=c.createRoundContainer(s.getFinalMatchLabel(e,t,a));r.append(this.createFinalMatch(e,o,t,a)),n.append(r)}}createRanking(e){const t=c.createTable(),n=a.getRanking(e);t.append(c.createRankingHeaders(n));for(const e of n)t.append(this.createRankingRow(e));return t}createRankingRow(e){const t=c.createRow();for(const n in e){const r=e[n];if("id"===n){const e=this.participants.find(e=>e.id===r);if(void 0!==e){const n=c.createCell(e.name);this.setupMouseHover(e.id,n),t.append(n);continue}}t.append(c.createCell(r))}return t}createBracketMatch(e,t,n,r,i){const o=c.getBracketConnection(e,t,r,i),a=s.getMatchLabel(n.number,e,t,r),u=s.getOriginHint(e,t,this.skipFirstRound,r);return this.createMatch(n,o,a,u,r,e)}createFinalMatch(e,t,n,r){const i=n-1,o=c.getFinalConnection(e,n,t.length),a=s.getFinalMatchLabel(e,n,r),u=s.getFinalOriginHint(e,n);return this.createMatch(t[i],o,a,u,"final-group")}createMatch(e,t,n,r,i,o){i=i||"upper-bracket";const a=c.createMatchContainer(),u=c.createOpponentsContainer(),d=this.createTeam(e.opponent1,r,i,o),l=this.createTeam(e.opponent2,r,i,o);return n&&u.append(c.createMatchLabel(n,s.getMatchStatus(e.status))),u.append(d,l),a.append(u),t?(c.setupConnection(u,a,t),a):a}createTeam(e,t,n,r){const i={participant:c.createParticipantContainer(),name:c.createNameContainer(),result:c.createResultContainer()};return null===e?i.name.innerText="BYE":this.renderParticipant(i,e,t,n,r),i.participant.append(i.name,i.result),e&&null!==e.id&&this.setupMouseHover(e.id,i.participant),i.participant}renderParticipant(e,t,n,r,i){const o=this.participants.find(e=>e.id===t.id);o?(e.name.innerText=o.name,this.renderTeamOrigin(e.name,t,r,i)):this.renderHint(e.name,t,n,r),e.result.innerText=""+(t.score||"-"),c.setupWin(e.participant,e.result,t),c.setupLoss(e.participant,e.result,t)}renderHint(e,t,n,r){void 0!==n&&void 0!==t.position&&this.config.showSlotsOrigin&&(this.config.showLowerBracketSlotsOrigin||"lower-bracket"!==r)&&c.setupHint(e,n(t.position))}renderTeamOrigin(e,t,n,r){if(void 0===t.position)return;if("none"===this.config.participantOriginPlacement)return;if(!this.config.showSlotsOrigin)return;if(!this.config.showLowerBracketSlotsOrigin&&"lower-bracket"===n)return;const i=a.getOriginAbbreviation(n,this.skipFirstRound,r)+t.position;c.addTeamOrigin(e,i,this.config.participantOriginPlacement)}setupMouseHover(e,t){this.config.highlightParticipantOnHover&&(this.teamRefsDOM[e].push(t),t.addEventListener("mouseover",()=>{this.teamRefsDOM[e].forEach(e=>e.classList.add("hover"))}),t.addEventListener("mouseleave",()=>{this.teamRefsDOM[e].forEach(e=>e.classList.remove("hover"))}))}}t.BracketsViewer=u,window.bracketsViewer=new u},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Status=void 0,function(e){e[e.Locked=0]="Locked",e[e.Waiting=1]="Waiting",e[e.Ready=2]="Ready",e[e.Running=3]="Running",e[e.Completed=4]="Completed",e[e.Archived=5]="Archived"}(t.Status||(t.Status={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupConnection=t.getFinalConnection=t.getBracketConnection=t.addTeamOrigin=t.setupLoss=t.setupWin=t.setupHint=t.createRankingHeaders=t.createCell=t.createRow=t.createTable=t.createResultContainer=t.createNameContainer=t.createParticipantContainer=t.createOpponentsContainer=t.createMatchLabel=t.createMatchContainer=t.createRoundContainer=t.createGroupContainer=t.createBracketContainer=t.createRoundRobinContainer=t.createTitle=void 0;const r=n(0),i=n(1);t.createTitle=function(e){const t=document.createElement("h1");return t.innerText=e,t},t.createRoundRobinContainer=function(){const e=document.createElement("div");return e.classList.add("round-robin"),e},t.createBracketContainer=function(){const e=document.createElement("section");return e.classList.add("bracket"),e},t.createGroupContainer=function(e){const t=document.createElement("h2");t.innerText=e;const n=document.createElement("section");return n.classList.add("group"),n.append(t),n},t.createRoundContainer=function(e){const t=document.createElement("h3");t.innerText=e;const n=document.createElement("article");return n.classList.add("round"),n.append(t),n},t.createMatchContainer=function(){const e=document.createElement("div");return e.classList.add("match"),e},t.createMatchLabel=function(e,t){const n=document.createElement("span");return n.innerText=e,n.title=t,n},t.createOpponentsContainer=function(){const e=document.createElement("div");return e.classList.add("opponents"),e},t.createParticipantContainer=function(){const e=document.createElement("div");return e.classList.add("participant"),e},t.createNameContainer=function(){const e=document.createElement("div");return e.classList.add("name"),e},t.createResultContainer=function(){const e=document.createElement("div");return e.classList.add("result"),e},t.createTable=function(){return document.createElement("table")},t.createRow=function(){return document.createElement("tr")},t.createCell=function(e){const t=document.createElement("td");return t.innerText=String(e),t},t.createRankingHeaders=function(e){const t=document.createElement("tr"),n=e[0];for(const e in n){const n=r.rankingHeader(e),i=document.createElement("th");i.innerText=n.text,i.setAttribute("title",n.tooltip),t.append(i)}return t},t.setupHint=function(e,t){e.classList.add("hint"),e.innerText=t},t.setupWin=function(e,t,n){n.result&&"win"===n.result&&(e.classList.add("win"),void 0===n.score&&(t.innerText=i.abbreviations.win))},t.setupLoss=function(e,t,n){(n.result&&"loss"===n.result||n.forfeit)&&(e.classList.add("loss"),n.forfeit?t.innerText=i.abbreviations.forfeit:void 0===n.score&&(t.innerText=i.abbreviations.loss))},t.addTeamOrigin=function(e,t,n){const r=document.createElement("span");"before"===n?(r.innerText=t+" ",e.prepend(r)):"after"===n&&(r.innerText=` (${t})`,e.append(r))},t.getBracketConnection=function(e,t,n,r){return"lower-bracket"===n?{connectPrevious:e>1&&(e%2==1?"square":"straight"),connectNext:e<t&&(e%2==0?"square":"straight")}:{connectPrevious:e>1&&"square",connectNext:e<t?"square":!!r&&"straight"}},t.getFinalConnection=function(e,t,n){return{connectPrevious:"grand_final"===e&&1===t&&"straight",connectNext:2===n&&1===t&&"straight"}},t.setupConnection=function(e,t,n){n.connectPrevious&&e.classList.add("connect-previous"),n.connectNext&&t.classList.add("connect-next"),"straight"===n.connectPrevious&&e.classList.add("straight"),"straight"===n.connectNext&&t.classList.add("straight")}}]);