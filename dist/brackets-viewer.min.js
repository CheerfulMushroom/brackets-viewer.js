!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRanking=t.rankingHeader=t.isMajorRound=t.getOriginAbbreviation=t.findRoot=t.splitBy=void 0;const r=n(1);function i(e,t,n,r){if(!n||null===n.id)return;const i=e[n.id]||{rank:0,id:0,played:0,wins:0,draws:0,losses:0,forfeits:0,scoreFor:0,scoreAgainst:0,scoreDifference:0,points:0};i.id=n.id,i.played++,"win"===n.result&&i.wins++,"draw"===n.result&&i.draws++,"loss"===n.result&&i.losses++,n.forfeit&&i.forfeits++,i.scoreFor+=n.score||0,i.scoreAgainst+=r&&r.score||0,i.scoreDifference=i.scoreFor-i.scoreAgainst,i.points=t(i),e[n.id]=i}t.splitBy=function(e,t){const n=Object();for(const r of e)n[r[t]]||(n[r[t]]=[]),n[r[t]].push(r);return Object.values(n)},t.findRoot=function(e){const t=document.querySelectorAll(e||".bracket-viewer");if(0===t.length)throw Error("Root not found. You must have at least one root element.");if(t.length>1)throw Error("Multiple possible roots were found. Please use `config.selector` to choose a specific root.");const n=t[0];if(!n.classList.contains("bracket-viewer"))throw Error("The selected root must have a `.bracket-viewer` class.");return n},t.getOriginAbbreviation=function(e,t,n){return t&&"lower-bracket"===e&&1===n?r.abbreviations.seed:"lower-bracket"===e||"final-group"===e?r.abbreviations.position:r.abbreviations.seed},t.isMajorRound=function(e){return 1===e||e%2==0},t.rankingHeader=function(e){return r.headers[e]},t.getRanking=function(e,t){t=t||(e=>3*e.wins+1*e.draws+0*e.losses);const n={};for(const r of e)i(n,t,r.opponent1,r.opponent2),i(n,t,r.opponent2,r.opponent1);return function(e){const t=Object.values(e).sort((e,t)=>t.points-e.points),n={value:0,lastPoints:-1};for(const e of t)e.rank=n.lastPoints!==e.points?++n.value:n.value,n.lastPoints=e.points;return t}(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headers=t.abbreviations=t.getLoserBracketRoundName=t.getWinnerBracketRoundName=t.getRoundName=t.getGroupName=t.getGrandFinalName=t.getMatchStatus=t.getFinalOriginHint=t.getFinalMatchLabel=t.getMatchLabel=t.getOriginHint=void 0;const r=n(4),i=n(0);function o(e,t){return 1===t?"Grand Final":"GF Round "+e}t.getOriginHint=function(e,t,n,r){if(1===e){if("single-bracket"===r)return e=>"Seed "+e;if("winner-bracket"===r)return e=>"Seed "+e;if("loser-bracket"===r&&n)return e=>"Seed "+e}if(i.isMajorRound(e)&&"loser-bracket"===r){if(e===t-2)return e=>"Loser of WB Semi "+e;if(e===t)return()=>"Loser of WB Final";const r=Math.ceil((e+1)/2);return n?e=>`Loser of WB ${r-1}.${e}`:e=>`Loser of WB ${r}.${e}`}},t.getMatchLabel=function(e,t,n,r){const i="winner-bracket"===r?"WB":"loser-bracket"===r?"LB":"M",o=t===n-1,a=t===n;if("single-bracket"===r){if(o)return"Semi "+e;if(a)return"Final"}return o?`${i} Semi ${e}`:a?i+" Final":`${i} ${t}.${e}`},t.getFinalMatchLabel=function(e,t,n){return"consolation_final"===e?"Consolation Final":o(t,n)},t.getFinalOriginHint=function(e,t){return"consolation_final"===e?e=>"Loser of Semi "+e:1===t?()=>"Winner of LB Final":void 0},t.getMatchStatus=function(e){switch(e){case r.Status.Locked:return"Locked";case r.Status.Waiting:return"Waiting";case r.Status.Ready:return"Ready";case r.Status.Running:return"Running";case r.Status.Completed:return"Completed";case r.Status.Archived:return"Archived"}},t.getGrandFinalName=o,t.getGroupName=function(e){return"Group "+e},t.getRoundName=function(e,t){return e===t?"Final Round":"Round "+e},t.getWinnerBracketRoundName=function(e,t){return e===t?"WB Final Round":"WB Round "+e},t.getLoserBracketRoundName=function(e,t){return e===t?"LB Final Round":"LB Round "+e},t.abbreviations={win:"W",loss:"L",forfeit:"F",position:"P",seed:"#"},t.headers={rank:{text:"#",tooltip:"Rank"},id:{text:"Name",tooltip:"Name"},played:{text:"P",tooltip:"Played"},wins:{text:t.abbreviations.win,tooltip:"Wins"},draws:{text:"D",tooltip:"Draws"},losses:{text:t.abbreviations.loss,tooltip:"Losses"},forfeits:{text:t.abbreviations.forfeit,tooltip:"Forfeits"},scoreFor:{text:"SF",tooltip:"Score For"},scoreAgainst:{text:"SA",tooltip:"Score Against"},scoreDifference:{text:"+/-",tooltip:"Score Difference"},points:{text:"Pts",tooltip:"Points"}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.BracketsViewer=void 0,n(3);const a=n(0),s=o(n(5)),c=o(n(1));class u{constructor(){this.teamRefsDOM={}}render(e,t){const n=a.findRoot(null==t?void 0:t.selector);this.config={participantOriginPlacement:t&&t.participantOriginPlacement||"before",showSlotsOrigin:!t||void 0===t.showSlotsOrigin||t.showSlotsOrigin,showLowerBracketSlotsOrigin:!t||void 0===t.showLowerBracketSlotsOrigin||t.showLowerBracketSlotsOrigin,highlightParticipantOnHover:!t||void 0===t.highlightParticipantOnHover||t.highlightParticipantOnHover},this.participants=e.participants,e.participants.forEach(e=>this.teamRefsDOM[e.id]=[]),e.stages.forEach(t=>this.renderStage(n,{...e,stages:[t],matches:e.matches.filter(e=>e.stage_id===t.id)}))}renderStage(e,t){const n=t.stages[0],r=a.splitBy(t.matches,"group_id");switch(this.skipFirstRound=n.settings.skipFirstRound||!1,n.type){case"round_robin":this.renderRoundRobin(e,n.name,r);break;case"single_elimination":case"double_elimination":this.renderElimination(e,n.name,n.type,r);break;default:throw Error("Unknown bracket type: "+n.type)}}renderRoundRobin(e,t,n){const r=s.createRoundRobinContainer();let i=1;for(const e of n){const t=e[0].group_id,n=s.createGroupContainer(t,c.getGroupName(i++)),o=a.splitBy(e,"round_id");let u=1;for(const e of o){const t=e[0].round_id,r=s.createRoundContainer(t,c.getRoundName(u++,0));for(const t of e)r.append(this.createMatch(t));n.append(r)}n.append(this.createRanking(e)),r.append(n)}e.append(s.createTitle(t),r)}renderElimination(e,t,n,r){e.append(s.createTitle(t)),"single_elimination"===n?this.renderSingleElimination(e,r):this.renderDoubleElimination(e,r)}renderSingleElimination(e,t){const n=void 0!==t[1];this.renderBracket(e,a.splitBy(t[0],"round_id"),c.getRoundName,"single-bracket"),n&&this.renderFinal("consolation_final",t[1])}renderDoubleElimination(e,t){const n=void 0!==t[1],r=void 0!==t[2];this.renderBracket(e,a.splitBy(t[0],"round_id"),c.getWinnerBracketRoundName,"winner-bracket",r),n&&this.renderBracket(e,a.splitBy(t[1],"round_id"),c.getLoserBracketRoundName,"loser-bracket"),r&&this.renderFinal("grand_final",t[2])}renderBracket(e,t,n,r,i){const o=t[0][0].group_id,a=t.length,c=s.createBracketContainer(o);let u=1;for(const e of t){const t=e[0].round_id,o=s.createRoundContainer(t,n(u,a));for(const t of e)o.append(this.createBracketMatch(u,a,t,r,i));c.append(o),u++}e.append(c)}renderFinal(e,t){const n=document.querySelector(".bracket");if(!n)throw Error("Upper bracket not found.");const r=t[0].opponent1,i=null===(null==r?void 0:r.id)||"win"===(null==r?void 0:r.result)?1:2,o=t.slice(0,i),a=t.length;for(let t=0;t<o.length;t++){const r=t+1,i=s.createRoundContainer(o[t].round_id,c.getFinalMatchLabel(e,r,a));i.append(this.createFinalMatch(e,o,r,a)),n.append(i)}}createRanking(e){const t=s.createTable(),n=a.getRanking(e);t.append(s.createRankingHeaders(n));for(const e of n)t.append(this.createRankingRow(e));return t}createRankingRow(e){const t=s.createRow();for(const n in e){const r=e[n];if("id"===n){const e=this.participants.find(e=>e.id===r);if(void 0!==e){const n=s.createCell(e.name);this.setupMouseHover(e.id,n),t.append(n);continue}}t.append(s.createCell(r))}return t}createBracketMatch(e,t,n,r,i){const o=s.getBracketConnection(e,t,r,i),a=c.getMatchLabel(n.number,e,t,r),u=c.getOriginHint(e,t,this.skipFirstRound,r);return this.createMatch(n,r,o,a,u,e)}createFinalMatch(e,t,n,r){const i=n-1,o=s.getFinalConnection(e,n,t.length),a=c.getFinalMatchLabel(e,n,r),u=c.getFinalOriginHint(e,n);return this.createMatch(t[i],"final-group",o,a,u)}createMatch(e,t,n,r,i,o){const a=s.createMatchContainer(e.id),u=s.createOpponentsContainer(),d=this.createTeam(e.opponent1,i,t,o),l=this.createTeam(e.opponent2,i,t,o);return r&&u.append(s.createMatchLabel(r,c.getMatchStatus(e.status))),u.append(d,l),a.append(u),n?(s.setupConnection(u,a,n),a):a}createTeam(e,t,n,r){const i={participant:s.createParticipantContainer(e&&e.id),name:s.createNameContainer(),result:s.createResultContainer()};return null===e?i.name.innerText="BYE":this.renderParticipant(i,e,t,n,r),i.participant.append(i.name,i.result),e&&null!==e.id&&this.setupMouseHover(e.id,i.participant),i.participant}renderParticipant(e,t,n,r,i){const o=this.participants.find(e=>e.id===t.id);o?(e.name.innerText=o.name,this.renderTeamOrigin(e.name,t,r,i)):this.renderHint(e.name,t,n,r),e.result.innerText=""+(t.score||"-"),s.setupWin(e.participant,e.result,t),s.setupLoss(e.participant,e.result,t)}renderHint(e,t,n,r){void 0!==n&&void 0!==t.position&&this.config.showSlotsOrigin&&(this.config.showLowerBracketSlotsOrigin||"loser-bracket"!==r)&&s.setupHint(e,n(t.position))}renderTeamOrigin(e,t,n,r){if(void 0===t.position||void 0===n)return;if(!this.config.participantOriginPlacement||"none"===this.config.participantOriginPlacement)return;if(!this.config.showSlotsOrigin)return;if(!this.config.showLowerBracketSlotsOrigin&&"loser-bracket"===n)return;const i=a.getOriginAbbreviation(n,this.skipFirstRound,r)+t.position;s.addTeamOrigin(e,i,this.config.participantOriginPlacement)}setupMouseHover(e,t){this.config.highlightParticipantOnHover&&(this.teamRefsDOM[e].push(t),t.addEventListener("mouseover",()=>{this.teamRefsDOM[e].forEach(e=>e.classList.add("hover"))}),t.addEventListener("mouseleave",()=>{this.teamRefsDOM[e].forEach(e=>e.classList.remove("hover"))}))}}t.BracketsViewer=u,window.bracketsViewer=new u},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Status=void 0,function(e){e[e.Locked=0]="Locked",e[e.Waiting=1]="Waiting",e[e.Ready=2]="Ready",e[e.Running=3]="Running",e[e.Completed=4]="Completed",e[e.Archived=5]="Archived"}(t.Status||(t.Status={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupConnection=t.getFinalConnection=t.getBracketConnection=t.addTeamOrigin=t.setupLoss=t.setupWin=t.setupHint=t.createRankingHeaders=t.createCell=t.createRow=t.createTable=t.createResultContainer=t.createNameContainer=t.createParticipantContainer=t.createOpponentsContainer=t.createMatchLabel=t.createMatchContainer=t.createRoundContainer=t.createGroupContainer=t.createBracketContainer=t.createRoundRobinContainer=t.createTitle=void 0;const r=n(0),i=n(1);t.createTitle=function(e){const t=document.createElement("h1");return t.innerText=e,t},t.createRoundRobinContainer=function(){const e=document.createElement("div");return e.classList.add("round-robin"),e},t.createBracketContainer=function(e){const t=document.createElement("section");return t.classList.add("bracket"),t.setAttribute("data-group-id",e.toString()),t},t.createGroupContainer=function(e,t){const n=document.createElement("h2");n.innerText=t;const r=document.createElement("section");return r.classList.add("group"),r.setAttribute("data-group-id",e.toString()),r.append(n),r},t.createRoundContainer=function(e,t){const n=document.createElement("h3");n.innerText=t;const r=document.createElement("article");return r.classList.add("round"),r.setAttribute("data-round-id",e.toString()),r.append(n),r},t.createMatchContainer=function(e){const t=document.createElement("div");return t.classList.add("match"),t.setAttribute("data-match-id",e.toString()),t},t.createMatchLabel=function(e,t){const n=document.createElement("span");return n.innerText=e,n.title=t,n},t.createOpponentsContainer=function(){const e=document.createElement("div");return e.classList.add("opponents"),e},t.createParticipantContainer=function(e){const t=document.createElement("div");return t.classList.add("participant"),null!==e&&t.setAttribute("data-participant-id",e.toString()),t},t.createNameContainer=function(){const e=document.createElement("div");return e.classList.add("name"),e},t.createResultContainer=function(){const e=document.createElement("div");return e.classList.add("result"),e},t.createTable=function(){return document.createElement("table")},t.createRow=function(){return document.createElement("tr")},t.createCell=function(e){const t=document.createElement("td");return t.innerText=String(e),t},t.createRankingHeaders=function(e){const t=document.createElement("tr"),n=e[0];for(const e in n){const n=r.rankingHeader(e),i=document.createElement("th");i.innerText=n.text,i.setAttribute("title",n.tooltip),t.append(i)}return t},t.setupHint=function(e,t){e.classList.add("hint"),e.innerText=t},t.setupWin=function(e,t,n){n.result&&"win"===n.result&&(e.classList.add("win"),void 0===n.score&&(t.innerText=i.abbreviations.win))},t.setupLoss=function(e,t,n){(n.result&&"loss"===n.result||n.forfeit)&&(e.classList.add("loss"),n.forfeit?t.innerText=i.abbreviations.forfeit:void 0===n.score&&(t.innerText=i.abbreviations.loss))},t.addTeamOrigin=function(e,t,n){const r=document.createElement("span");"before"===n?(r.innerText=t+" ",e.prepend(r)):"after"===n&&(r.innerText=` (${t})`,e.append(r))},t.getBracketConnection=function(e,t,n,r){return"loser-bracket"===n?{connectPrevious:e>1&&(e%2==1?"square":"straight"),connectNext:e<t&&(e%2==0?"square":"straight")}:{connectPrevious:e>1&&"square",connectNext:e<t?"square":!!r&&"straight"}},t.getFinalConnection=function(e,t,n){return{connectPrevious:"grand_final"===e&&1===t&&"straight",connectNext:2===n&&1===t&&"straight"}},t.setupConnection=function(e,t,n){n.connectPrevious&&e.classList.add("connect-previous"),n.connectNext&&t.classList.add("connect-next"),"straight"===n.connectPrevious&&e.classList.add("straight"),"straight"===n.connectNext&&t.classList.add("straight")}}]);